 {% extends "layout.html" %}
{% block title %}Editor{% endblock %}
{% block head %}
	{{ super() }}
{% endblock %}

{% block options %}
	<br>
	<p class="nav-link" data-toggle="modal" data-target="#generateExamsModal" href="">Generar exámenes</p>
{% endblock %}


{% block content %}
	<div id="formatoPregunta" style="display: none">
		<section class="pregunta">
			<br>
			<table style="width:100%; min-width:500px">
				<tr>
					<td>
						<label>Enunciado:</label>
					</td>
				</tr>
				<tr>
					<td colspan="2">
						<input type="text" class="form-control question" name="question" onchange="Saved=false">
					</td>
				</tr>
				<tr>
					<td>
						<label><input type="checkbox" value="T" name="algebra" onchange="toggleQuestion(this, this.parentElement.parentElement.parentElement.nextElementSibling.nextElementSibling.firstChild, this.parentElement.parentElement.parentElement.nextElementSibling.firstChild)">Algebraico?</label>
					</td>
				</tr>
				<tr><td colspan="2"><table style="width:100%">
					<tr>
						<td>
							<label class="form-l">Respuesta Correcta:</label>
						</td>
						<td>
							<input type="text" class="form-control answer" name="1" onchange="Saved=false">
						</td>
					</tr>
					<tr>
						<td style="vertical-align: top">
							<label class="form-l">Distractores:</label>
						</td>
						<td>
							<input style="margin-bottom:2px" type="text" class="form-control answer" name="2" onchange="Saved=false">
							<input style="margin-bottom:2px" type="text" class="form-control answer" name="3" onchange="Saved=false">
							<input style="margin-bottom:2px" type="text" class="form-control answer" name="4" onchange="Saved=false">
						</td>
					</tr>
				</table></td></tr>
				<tr><td colspan="2" style="display:none"><table style="width:100%">
					<tr>
						<td>
							<label class="form-l">Formula:</label>
						</td>
						<td>
							<input type="text" class="form-control formula" name="5" onchange="Saved=false">
						</td>
					</tr>
				</table></td></tr>
				<tr>
					<td colspan="2">
						<br>
						<center>
							<button type="button" class="btn btn-danger" onclick="deleteQuestion(this.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement)">Eliminar pregunta</button>
						</center>
					</td>
				</tr>
			</table>
		</section>
	</div>

	<br><br>
	<center><h1>Editando: {{ evalName }}</h1></center>

	<form id="editor" action="submitEval" method="POST">
		<input type="hidden" value={{ user }}>
		<!-- Aqui habra un if (ya tiene preguntas traidas de la BD) /entonces/ las despliego en el editor /else/ despliego -->
		<script>addQuestion();</script>
	</form>

	<br>
	<center><button class="btn btn-success" href="" onclick="addQuestion()">Agregar pregunta</button></center>
	<br>
	<button type="button" class="btn btn-primary" data-dismiss="modal" style="float:right" onclick="save()">Guardar cambios</button>
	<p id="messageError" style="color:red"></p>
	

	<div class="modal" id="deleteQuestionModal">
		<div class="modal-dialog">
			<div class="modal-content">
			    <!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Eliminar pregunta</h4>
			    	<button type="button" class="close" data-dismiss="modal">&times;</button>
			    </div>
			  	<!-- Modal body -->
			  	<div class="modal-body">
    				<label for="name">¿Desea eliminar la pregunta?</label>
			  	</div>
			  	<!-- Modal footer -->
			  	<div class="modal-footer">
			  		<button type="button" class="btn btn-primary" onclick="confirmDeleteQuestion()" data-dismiss="modal">Eliminar</button>
			    	<button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
			  	</div>
			  	<input type="hidden" value={{ user }} name="user">
			</div>
		</div>
	</div>

	<div class="modal" id="generateExamsModal">
		<div class="modal-dialog">
			<div class="modal-content">
			    <!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Crear exámenes</h4>
			    	<button type="button" class="close" data-dismiss="modal">&times;</button>
			    </div>
			    <form action="generateExams" method="POST" id="generateExamsForm">
				  	<!-- Modal body -->
				  	<div class="modal-body">
			    		<div class="form-group">
    						<label>Número de reactivos por examen:</label>
    						<input type="number" min="1" class="form-control" name="reactivos">
 						</div>
 						<div class="form-group">
    						<label>Cantidad de exámenes a generar:</label>
    						<input type="number" min="1" class="form-control" name="exams">
 						</div>
 						<p id="generateExamsError" style="color:red"></p>
 						<p id="generateExamsSuccess" style="color:green"></p>
 						<input type="hidden" name="user" value={{ user }}>
 						<input type="hidden" name="evalName" value={{ evalName }}>
				  	</div>
				  	<input type="hidden" value={{ user }} name="user">
				</form>
			  	<!-- Modal footer -->
			  	<div class="modal-footer">
			  		<button type="button" class="btn btn-primary" onclick="generateExams()">Crear</button>
			    	<button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
			  	</div>
			</div>
		</div>
	</div>
{% endblock %}